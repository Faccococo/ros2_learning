# ROS 学习笔记
设备信息：
CPU：i7 12650H
操作系统： Ubuntu22.04 in WSL2
内核版本：5.15.90.1-microsoft-standard-WSL2

[TOC]

## 1.ROS2的安装
参考官方文档：https://docs.ros.org/en/humble/Tutorials.html
注：在执行sudo add-apt-repository universe命令时，可能出现证书过期的报错。解决方法参考 https://answers.ros.org/question/410123/ubuntu-2204-ros2-humble-installing-error-gpg-libc-bin/

## 2.概念
### 2.1. 一些基础概念
![concepts](images/concepts.png)

### 2.2. 工作空间

类似于"项目"的概念。一个工作空间结构一般分为以下四个部分：
├── build
├── install
├── log
└── src
- src，代码空间，未来编写的代码、脚本，都需要人为的放置到这里；
- build，编译空间，保存编译过程中产生的中间文件；
- install，安装空间，放置编译得到的可执行文件和脚本；
- log，日志空间，编译和运行过程中，保存各种警告、错误、信息等日志。

### 2.3. 功能包
类似于"模块"，存放实现了某个功能的特定代码

创建功能包：
```
ros2 pkg create --build-type <build-type> <package_name>
```
- build-type：表示新创建的功能包是C++还是Python的，如果使用C++或者C，那这里就ament_cmake，如果使用Python，就跟ament_python；
- package_name：新建功能包的名字。

#### 功能包的结构
这里只列出C++的部分。python基本相同，区别为python通过setup.py指定入口，C++通过CMakeList.txt。

├── CMakeLists.txt
├── include
├── package.xml
└── src

其他就不说了，主要说说package.xml.
package.xml存的大概是版权描述与各种依赖的声明。用过maven的同学应该会比较熟悉。

注意：功能包不可嵌套。

### 2.4. 节点
在机器人系统中负责某个具体任务的部分。每个节点都是一个可以独立运行的可执行文件，通过某种方式进行信息交换。

## 通信

### 2.5. 话题(Topic)
**订阅者-发布着** 模式，异步通信。订阅者订阅话题，发布者向话题不停推送数据, **而不管订阅者是否能收到**.订阅者可以订阅一个话题，不停获取发布者发布的数据。

### 2.6. 服务：
**客户端-服务端**模式，同步通信。当客户端有获取数据的需求时才向服务端发送请求。

### 2.7. 通信接口
类似于java的接口。话题、服务与动作可以通过接口自定义信息的格式。 同一通信接口支持不同编程语言使用。

### 2.8. 动作
高层的通信协议，由**服务与话题**构成。
同样使用**客户端-服务端**模式，客户端发送动作，服务端执行动作并返回值。
动作的三个通信模块，两个是服务，一个是话题，当客户端发送运动目标时，使用的是服务的请求调用，服务器端也会反馈一个应带，表示收到命令。动作的反馈过程，其实就是一个话题的周期发布，服务器端是发布者，客户端是订阅者。
![action](images/action.gif)

### 2.9. 参数
参数是ROS机器人系统中的全局字典，可以运行多个节点中共享数据。

### 2.10 分布式通信
只要两个计算机安装好ROS2，并且处于同一网络中，他们就可以实现话题、服务、动作等通信了，就像在一个电脑里一样。




## 3. 常用工具

### 3.1 colcon: ros2的构建工具
在功能包代码编写完成后，可以使用colcon build命令构建项目。

### 3.2 tf：机器人坐标系转换工具

### 3.3 Gazebo：三维物理仿真平台

### Rviz：三维可视化显示平台

## 4. 在vscode中开发ros2